"use strict";function _defineProperty(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function raiseValidationErrorModal(n){$("#msg_dlg_modal_hdr").text("Error");$("#msg_dlg_modal_text").text(n);$("#msg_dlg_modal").modal()}function raiseErrorModal(n){$("#msg_dlg_modal_hdr").text("Error");$("#msg_dlg_modal_text").text(n.userError);$("#msg_dlg_modal").modal()}function raiseYesNoModal(n,t,i){$("#yesno_dlg_modal_hdr").text(n);$("#yesno_dlg_modal_text").text(t);$("#yesno_dlg_modal_yesbtn").click(i);$("#yesno_dlg_modal").modal()}function hasRequiredValues(n,t){for(var r,u,i=0;i<n.length;i++)for(r=0;r<t.length;r++)if((u=t[r],!n[i][u])||!1)return!1;return!0}function getVueCreateUpdate(n,t,i,r){return new Vue({el:n,data:{dataview:[],valuedomains:{},model:_defineProperty({},i,{}),validation:{},viewretrieveinfo:{applicationId:t,dataViewMetaCode:"",maxCount:0,batchSize:10,currentRowNum:0,filterField:"",filterValue:""},current_edit_line:{}},methods:{saveApplication:function(){this.runSave()},onFileUpload:function(){},onImageChanged:function(n){var u=this,f=r+"UploadImage",i=new FormData,t;i.append("File",n.srcElement.files[0]);i.append("FileName",n.srcElement.files[0].name);i.append("FileSize",n.srcElement.files[0].size);t=new XMLHttpRequest;t.onreadystatechange=function(){var e;if(t.readyState===4){var i=n.srcElement.dataset.dbtable,r=n.srcElement.dataset.dbfield,f=JSON.parse(t.response);u.model[i][r]="/USERDOC/"+f.fileName;u.$forceUpdate();e=""}};t.open("POST",f,!0);t.send(i)},canSave:function(){var n=this,t=!0;return $("[data-required]").each(function(){var s=$(this).data("required"),i;if(s==="True"){var r=$(this).data("validationfield"),h=$(this).attr("id"),e=$(this).data("title"),o=$(this).data("metatype"),u=$(this).data("dbfield"),f=$(this).data("dbtable");n.model[f][u]?n.model[f][u].length==0?(t=!1,$(this).addClass("requiredNotValid"),n.setValidationText(r,e+" is required")):(o=="EMAILBOX"&&(i=isValidEmail(n.model[f][u]),i.result||(t=!1,$(this).addClass("requiredNotValid"),n.setValidationText(r,i.msg))),o=="PASSWORDBOX"&&(i=isValidPassword(n.model[f][u]),i.result||(t=!1,$(this).addClass("requiredNotValid"),n.setValidationText(r,i.msg))),t&&(n.clearValidationText(r),$(this).removeClass("requiredNotValid"))):(t=!1,$(this).addClass("requiredNotValid"),n.setValidationText(r,e+" is required"))}}),t},setValidationText:function(n,t){this.validation&&n&&(n.length<1||(this.validation[n]=t,this.$forceUpdate()))},clearValidationText:function(n){this.validation&&n&&(n.length<1||(this.validation[n]="",this.$forceUpdate()))},onUserInput:function(n){if(n){var t=n.srcElement.id;t&&$("[data-required]").each(function(){var r=$(this).data("required"),u=$(this).attr("id"),i;r==="True"&&u===t&&(i=n.srcElement.value,i&&i.length>0&&$("#"+t).removeClass("requiredNotValid"))})}},setSelectedDataViewValue:function(n,t){var i=this;$("input[data-lookupid]").each(function(){var f=$(this).data("lookupid"),r,u;f===t&&(r=$(this).data("dbfield"),u=$(this).data("viewfield"),i.current_edit_line[r]=n[u])});i.$forceUpdate()},getDataViewValue:function(n,t,u){var f=this,e;(f.viewretrieveinfo.dataViewMetaCode=n,$("input[data-lookupid]").each(function(){var e=$(this).data("lookupid"),n,r;e===u&&(n=$(this).data("dbfield"),r=$(this).data("viewfield"),n===t&&(f.viewretrieveinfo.filterField=r,f.viewretrieveinfo.filterValue=f.model[i][n]))}),f.viewretrieveinfo.filterValue)&&f.viewretrieveinfo.filterValue.length!=0&&(e=r+"GetDataViewValue",$.ajax({url:e,type:"POST",contentType:"application/json",data:JSON.stringify(f.viewretrieveinfo),success:function(n){var t=JSON.parse(n.data);$("input[data-lookupid]").each(function(){var e=$(this).data("lookupid"),n,r;e===u&&(n=$(this).data("dbfield"),r=$(this).data("viewfield"),f.model[i][n]=t[r],f.$forceUpdate())})}}))},openDataViewLookUp:function(n,t){n&&(this.viewretrieveinfo.maxCount=0,this.viewretrieveinfo.currentRowNum=0,this.viewretrieveinfo.filterField="",this.viewretrieveinfo.filterValue="",this.viewretrieveinfo.dataViewMetaCode=n,this.getDataViewLookUpPage(),this.current_edit_line=t,$("#"+n).modal())},nextDataViewLookUpPage:function(){var n=this;n.viewretrieveinfo.currentRowNum+=n.viewretrieveinfo.batchSize;n.getDataViewLookUpPage()},prevDataViewLookUpPage:function(){var n=this;n.viewretrieveinfo.currentRowNum-=n.viewretrieveinfo.batchSize;n.getDataViewLookUpPage()},getDataViewLookUpPage:function(){var n=this,t=r+"GetDataView";$.ajax({url:t,type:"POST",contentType:"application/json",data:JSON.stringify(n.viewretrieveinfo),success:function(t){n.dataview=JSON.parse(t.data);n.viewretrieveinfo=t.retriveListArgs}})},isFirstDataViewPage:function(){return this.listRetrieveInfo.currentRowNum<=0},handleDataViewFilter:function(){var n=this;n.viewretrieveinfo.currentRowNum=0;n.getDataViewLookUpPage()},addSubTableLine:function(n){var t=this;t.model[n].push({Id:0,ParentId:0});t.$forceUpdate()}},mounted:function(){this.runMounted()}})}function getVueListView(n,t,i){return new Vue({el:n,data:{datalist:[],model:{filtervalue:"",filterfield:""},listRetrieveInfo:{applicationId:t,maxCount:0,dataViewMetaCode:"",listViewMetaCode:"",batchSize:20,currentRowNum:0,filterField:"",filterValue:""},currentSort:"",currentSortDir:"asc",baseUrl:i},methods:{downloadExcel:function(){var n=this;alert("test")},nextpage:function(){var n=this;n.listRetrieveInfo.currentRowNum+=n.listRetrieveInfo.batchSize;n.getPage()},prevpage:function(){var n=this;n.listRetrieveInfo.currentRowNum-=n.listRetrieveInfo.batchSize;n.getPage()},getPage:function(){var n=this,t=n.baseUrl+"GetListView";$.ajax({url:t,type:"POST",contentType:"application/json",data:JSON.stringify(this.listRetrieveInfo),success:function(t){n.datalist=JSON.parse(t.data);n.listRetrieveInfo=t.retriveListArgs}})},handleFilterValue:function(){var n=this;n.model.filterfield&&n.model.filterfield!=""&&n.model.filtervalue!=""&&n.model.filtervalue!=n.listRetrieveInfo.filterValue&&(n.listRetrieveInfo.currentRowNum=0,n.listRetrieveInfo.filterField=n.model.filterfield,n.listRetrieveInfo.filterValue=n.model.filtervalue,n.getPage())},sortBycolumn:function(n){n===this.currentSort&&(this.currentSortDir=this.currentSortDir==="asc"?"desc":"asc");this.currentSort=n},exportToExcel:function(){var n={applicationId:t,maxCount:0,dataViewMetaCode:"",listViewMetaCode:"",batchSize:2e3,currentRowNum:0,filterField:"",filterValue:""},i=this,r=i.baseUrl+"GetListView";$.ajax({url:r,type:"POST",contentType:"application/json",data:JSON.stringify(n),success:function(n){var t=JSON.parse(n.data);alasql.promise('SELECT * INTO XLSX("download.xlsx",{headers:true}) FROM ?',[t]).then(function(){console.log("Data saved")})["catch"](function(n){console.log("Error:",n)})}})}},computed:{sortedResults:function(){var n=this;return this.datalist.sort(function(t,i){var r=1;return(n.currentSortDir==="desc"&&(r=-1),t[n.currentSort]<i[n.currentSort])?-1*r:t[n.currentSort]>i[n.currentSort]?1*r:0})},isFirstPage:function(){return this.listRetrieveInfo.currentRowNum<=0}},mounted:function(){var n=this;n.getPage()}})}